# Software Design Request 300 | Fourier Series Synthesis on K22F

## Setup
Letting **A** and **B** designate the first two non-zero least significant digits of your NDSU student ID, define a T = 40 periodic signal x(t) as:

$$
x(t) = \begin{cases}
0 & -20 \leq t < -(B + 10) \\
-t/(B + 10) & -(B + 10) \leq t < 0 \\
2t/(A + 10) & 0 \leq t < A + 10 \\
0 & A + 10 \leq t < 20 \\
x(t + 40) & \forall t
\end{cases}
$$

In this problem, you will implement a method to output a periodic signal $y_K(t)$, the truncated Fourier series (FS) of the signal $y(t) = c_1 + c_2 x(c_3 t)$. That is, output $y_K(t)$ as:

$$
y_K(t) = \sum_{k=-K}^{K} Y_k e^{jk\omega_0 t}
$$

where $Y_k$ are the FS coefficients of the signal $y(t)$.

## Part (a)
Plot the signal $x(t)$ over 2 periods.

## Part (b)
Determine constants $c_1$ and $c_2$ to maximize the output amplitude range of $y_K(t)$ yet provide some buffer against saturation and clipping.

## Part (c)
Determine constant $c_3$ so that $y_K(t)$ has highest possible frequency yet maintains adequate signal quality for $1 \leq K \leq 10$.

## Part (d)
Derive the necessary Fourier series coefficients $Y_k$. Create MATLAB plots of $y_K(t)$ over 2 periods for $1 \leq K \leq 10$.

## Part (e)
Devise an algorithm to output the desired waveform on the K22F. Validate your algorithm with MATLAB code structured as close as possible to your final C-code implementation.

**Important considerations:**
- While MATLAB seamlessly supports complex numbers and vector operations, C does not
- Represent complex numbers in your MATLAB code using pairs of reals
- Compute vector operations using explicit loops, just as you would in C
- If you can devise a way so that you don't need to use complex numbers, that may be preferable...

## Keil Implementation
Create a project in Keil to output your designed waveform.

**Requirements:**
- Output $y_K(t)$ on the DAC channel at a rate of one sample every 0.1 ms (10 kHz sampling rate)
- The number of terms $K$ used in the approximation $y_K(t)$ must be run-time adjustable between 1 and 10
  - Adjust the number of terms through button presses (preferred method; one button to increase, the other to decrease) or watch-window (less preferred method)
- Turn on an LED when you enter the ISR and turn the LED off when you exit the ISR

## Hardware Testing
To test your C program on the DSK, complete the following:

**Verification Steps:**
- Verify the output waveform shape for each case using an oscilloscope
  - Most oscilloscopes in lab will calculate the period, frequency, amplitude and other information pertinent to a waveform automatically
  - Use these features to appropriately measure your waveform
  - **Question:** How close are your waveforms to theoretical?

- Use an oscilloscope to measure the LED "on-time"
  - **Question:** What percentage of the available processing time is being used to generate your waveform?
  - **Question:** Does the processing time vary with K?

**Proper guidelines**
1. Sign up to demonstrate your working hardware to the course instructor for check-off
2. Summarize your approach, findings, and calculations in a short write-up
3. Attach a copy of your properly documented C-code

