# Software Design Document 301 | Fourier Integration
## Overview
The scope of this document is limited to describing the hardware integration of the Fourier series synthesizer described in SDD301.

## Mapping Simulation to C
Using the table from SDD301

| k  | a (real)     | b (imag)      |
|----|--------------|---------------|
| 0  | 1216.31250   | 0             |
| 1  | 239.289971   | -165.95771119 |
| 2  | -431.916129  | -195.58403878 |
| 3  | -210.324415  | 23.32248174   |
| 4  | 140.142399   | 137.37739398  |
| 5  | 8.48982269   | -55.14791232  |
| 6  | -109.377703  | -97.56772502  |
| 7  | -0.805273241 | 87.26825469   |
| 8  | 40.4644281   | 45.95872345   |
| 9  | -13.1241907  | -94.88022582  |
| 10 | -34.1638594  | 4.83160338    |

and function:
```python
def fft_synth_real(Y_k, omega_0, K, t):
    y = np.real(Y_k[0]) * np.ones(len(t))
    for k in range(1, K+1):
        a_k = 2 * np.real(Y_k[k])      # Factor of 2 to account for -k
        b_k = -2 * np.imag(Y_k[k])

        # Apply Eulers and seperate for hardware realization (C doesn't do j)
        y += a_k * np.cos(k * omega_0 * t) + b_k * np.sin(k * omega_0 * t)
    return y
```
it roughly translate to C with:

```c
#define REAL 0
#define IMAG 1
#define KMAX 10

static float Y[KMAX+1][2] = {
    { 1216.31250,    0.0          },
    { 239.289971,   -165.95771119 },
    {-431.916129,   -195.58403878 },
    {-210.324415,    23.32248174  },
    { 140.142399,   137.37739398  },
    {   8.48982269, -55.14791232  },
    {-109.377703,   -97.56772502  },
    {  -0.805273241, 87.26825469  },
    {  40.4644281,   45.95872345  },
    { -13.1241907,  -94.88022582  },
    { -34.1638594,    4.83160338  }
};

static uint8_t K_selected = KMAX;

static inline float fft_synth(float t) {
    float y = Y[0][REAL];  // DC term
    for (int k = 1; k <= K_selected; k++) {
        y += 2.0f * Y[k][REAL] * cosf(k * omega_0 * t)
           - 2.0f * Y[k][IMAG] * sinf(k * omega_0 * t);
    }
    return y;
}
```

